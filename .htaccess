# .htaccess Security Configuration
# Place this in your root directory

# Protect database configuration file
<Files "db-config.php">
    Order Allow,Deny
    Deny from all
</Files>

# Protect CSRF token generator if accessed directly
<Files "generate-csrf-token.php">
    Order Allow,Deny
    Deny from all
</Files>

# Enable PHP error logging (disable display in production)
# php_flag display_errors Off
# php_flag log_errors On
# php_value error_log /path/to/your/error_log

# Prevent directory browsing
Options -Indexes

# Protect against clickjacking
Header always append X-Frame-Options SAMEORIGIN

# XSS Protection
Header set X-XSS-Protection "1; mode=block"

# Prevent MIME type sniffing
Header set X-Content-Type-Options "nosniff"

# Enable HTTPS (uncomment when SSL is active)
# RewriteEngine On
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Redirect join.html to join.php
RewriteEngine On
RewriteRule ^join\.html$ join.php [L,R=301]